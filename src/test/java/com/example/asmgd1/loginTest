package com.example.asmgd1.asm.model;

import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

class loginTest {

    @BeforeEach
    void setUp() {
        // Thiết lập trước khi mỗi trường hợp kiểm thử được chạy (có thể là khởi tạo dữ liệu mẫu)
    }

    @AfterEach
    void tearDown() {
        // Dọn dẹp sau khi mỗi trường hợp kiểm thử được chạy (có thể là xóa dữ liệu hoặc khôi phục trạng thái)
    }

    @Test
    void testLoginValidCredentials() {
        // Kiểm thử với thông tin đăng nhập hợp lệ
        String username = "validUser";
        String password = "validPassword";
        assertTrue(login(username, password), "Đăng nhập thành công với thông tin hợp lệ.");
    }

    @Test
    void testLoginInvalidUsername() {
        // Kiểm thử với tên người dùng không hợp lệ
        String username = "invalidUser";
        String password = "validPassword";
        assertFalse(login(username, password), "Đăng nhập thất bại vì tên người dùng không hợp lệ.");
    }

    @Test
    void testLoginInvalidPassword() {
        // Kiểm thử với mật khẩu không hợp lệ
        String username = "validUser";
        String password = "invalidPassword";
        assertFalse(login(username, password), "Đăng nhập thất bại vì mật khẩu không hợp lệ.");
    }

    @Test
    void testLoginEmptyUsername() {
        // Kiểm thử với tên người dùng để trống
        String username = "";
        String password = "validPassword";
        assertFalse(login(username, password), "Đăng nhập thất bại vì tên người dùng để trống.");
    }

    @Test
    void testLoginEmptyPassword() {
        // Kiểm thử với mật khẩu để trống
        String username = "validUser";
        String password = "";
        assertFalse(login(username, password), "Đăng nhập thất bại vì mật khẩu để trống.");
    }

    @Test
    void testLoginNullUsername() {
        // Kiểm thử với tên người dùng là null
        String username = null;
        String password = "validPassword";
        assertFalse(login(username, password), "Đăng nhập thất bại vì tên người dùng là null.");
    }

    @Test
    void testLoginNullPassword() {
        // Kiểm thử với mật khẩu là null
        String username = "validUser";
        String password = null;
        assertFalse(login(username, password), "Đăng nhập thất bại vì mật khẩu là null.");
    }

    @Test
    void testLoginInvalidCredentialsFormat() {
        // Kiểm thử với định dạng tên người dùng hoặc mật khẩu không hợp lệ (ví dụ: ký tự đặc biệt không hợp lệ)
        String username = "user@name";
        String password = "pass@word";
        assertFalse(login(username, password), "Đăng nhập thất bại vì định dạng thông tin không hợp lệ.");
    }

    @Test
    void testLoginSQLInjectionAttempt() {
        // Kiểm thử với cố gắng SQL Injection trong tên người dùng
        String username = "validUser' OR '1'='1";
        String password = "password";
        assertFalse(login(username, password), "Đăng nhập thất bại vì cố gắng tấn công SQL Injection.");
    }

    @Test
    void testLoginCaseSensitivity() {
        // Kiểm thử với sự phân biệt chữ hoa chữ thường trong tên người dùng và mật khẩu
        String username = "ValidUser";
        String password = "ValidPassword";
        assertTrue(login(username, password), "Đăng nhập thành công với thông tin chính xác và phân biệt chữ hoa chữ thường.");
    }

    // Giả sử phương thức login() là phương thức kiểm tra đăng nhập
    private boolean login(String username, String password) {
        // Đây là ví dụ phương thức đăng nhập, cần thay thế bằng logic thực tế
        if (username == null || password == null) {
            return false;
        }
        if (username.equals("validUser") && password.equals("validPassword")) {
            return true;
        }
        return false;
    }
}
